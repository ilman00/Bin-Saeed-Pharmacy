<%- include('partials/header') %>
<body class="bg-light min-vh-100 d-flex flex-column">
  <%- include('partials/navbar') %>

  <div class="container mt-5 flex-grow-1">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="text-primary">ðŸ§¾ Transaction History</h2>
    </div>

    <div class="card shadow-sm">
      <div class="card-body p-4">
        <div class="table-responsive">
          <table class="table table-hover align-middle text-center">
            <thead class="table-primary">
              <tr>
                <th scope="col">Date</th>
                <th scope="col">Items</th>
                <th scope="col">Grand Total</th>
                <th scope="col">Salesperson</th>
              </tr>
            </thead>
            <tbody>
              <% if (transactions.length === 0) { %>
                <tr>
                  <td colspan="4" class="text-muted">No transactions found.</td>
                </tr>
              <% } %>
              <% transactions.forEach(function(transaction) { %>
                <tr class="table-light">
                  <td><%= new Date(transaction.createdAt).toLocaleString() %></td>

                  <td>
                    <ul class="list-unstyled mb-0">
                      <% transaction.items.forEach(function(item) { %>
                        <li>
                          <strong><%= item.brand %></strong> 
                          (<%= item.quantity %> Ã— Rs.<%= item.price.toFixed(2) %>)
                        </li>
                      <% }) %>
                    </ul>
                  </td>

                  <td class="fw-bold text-success">Rs.<%= transaction.totalPrice.toFixed(2) %></td>

                  <td><%= transaction.salesperson?.name || 'N/A' %></td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <footer class="mt-auto py-3 bg-white text-center border-top">
    <small class="text-muted">Â© <%= new Date().getFullYear() %> Your Medical Store</small>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

